{
  "Header": {
    "_": [
      " This requires vsSolutionBuildEvent engine.",
      " Free plugin for Visual Studio or MSBuild Tools:",
      "  * https://github.com/3F/vsSolutionBuildEvent",
      "  * https://visualstudiogallery.msdn.microsoft.com/0d1dbfd7-ed8a-40af-ae39-281bfeca2334/",
      " Feedback: github.com/3F  or entry.reg@gmail.com"
    ],
    "Compatibility": "0.9"
  },
  "Components": [
    {
      "ClassName": "InternalComponent",
      "Enabled": true
    },
    {
      "ClassName": "UserVariableComponent",
      "Enabled": true
    },
    {
      "ClassName": "TryComponent",
      "Enabled": true
    },
    {
      "ClassName": "OWPComponent",
      "Enabled": true
    },
    {
      "ClassName": "NuGetComponent",
      "Enabled": true
    },
    {
      "ClassName": "FunctionComponent",
      "Enabled": true
    },
    {
      "ClassName": "FileComponent",
      "Enabled": true
    },
    {
      "ClassName": "DTEComponent",
      "Enabled": true
    },
    {
      "ClassName": "BuildComponent",
      "Enabled": true
    },
    {
      "ClassName": "BoxComponent",
      "Enabled": true
    },
    {
      "ClassName": "SevenZipComponent",
      "Enabled": true
    },
    {
      "ClassName": "ConditionComponent",
      "Enabled": true
    },
    {
      "ClassName": "MSBuildComponent",
      "Enabled": true
    },
    {
      "ClassName": "CommentComponent",
      "Enabled": true
    }
  ],
  "PreBuild": [
    {
      "Enabled": true,
      "Name": "RestorePkg",
      "Caption": "To restore packages - nuget etc.",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": false,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "$(revDeltaBase  = \"2016/11/05\")\n$(revDeltaMin   = $([System.Math]::Pow(10, 3)))\n$$(revDeltaMax   = $([System.Math]::Pow(10, 5)))\n$(revDeltaMax   = 65534) #[\" limit of AssemblyVersion (2^16 - 2) - i.e. 65534 max allowed \"]\n\n#[\" \n    To restore packages via GetNuTool\n    https://github.com/NuGet/Home/issues/1521\n\"]\n##[NuGet gnt.raw(\"/p:ngconfig=\\\".gnt/packages.config\\\"\")]",
        "Command__": [
          "$(revDeltaBase  = \"2016/11/05\")",
          "$(revDeltaMin   = $([System.Math]::Pow(10, 3)))",
          "$$(revDeltaMax   = $([System.Math]::Pow(10, 5)))",
          "$(revDeltaMax   = 65534) #[\" limit of AssemblyVersion (2^16 - 2) - i.e. 65534 max allowed \"]",
          "",
          "#[\" ",
          "    To restore packages via GetNuTool",
          "    https://github.com/NuGet/Home/issues/1521",
          "\"]",
          "##[NuGet gnt.raw(\"/p:ngconfig=\\\".gnt/packages.config\\\"\")]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "Definitions",
      "Caption": "Prepares data",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": false,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[\"\n    Prepares data - version, revBuild & information from git\n\"]\n\n#[var tBase     = $([System.DateTime]::Parse('$(revDeltaBase)').ToBinary())]\n#[var tNow      = $([System.DateTime]::UtcNow.Ticks)]\n#[var revBuild  = $([System.TimeSpan]::FromTicks('$([MSBuild]::Subtract($(tNow), $(tBase)))').TotalMinutes.ToString('0'))]\n#[var revBuild  = $([MSBuild]::Add($(revDeltaMin), $([MSBuild]::Modulo($(revBuild), $([MSBuild]::Subtract($(revDeltaMax), $(revDeltaMin)))))))]\n\n#[var tplVersion = #[File get(\"Version.tpl\")]]\n\n#[var pDir          = vsSolutionBuildEvent/]\n#[var pDirBridge    = Bridge/]\n#[var pDirCIM       = CI.MSBuild/]\n#[var pDirDevenv    = Devenv\\]\n#[var pDirProvider  = Provider/]\n#[var pMvsSln       = MvsSln/]\n\n#[var numSBE        = #[File get(\".version\")]]\n#[var numBridge     = #[File get(\"#[var pDirBridge].version\")]]\n#[var numCIM        = #[File get(\"#[var pDirCIM].version\")]]\n#[var numDevenv     = #[File get(\"#[var pDirDevenv].version\")]]\n#[var numProvider   = #[File get(\"#[var pDirProvider].version\")]]\n\n#[\" the 0 number is reserved for patches from external assemblies /see AssemblyInfo \"]\n\n#[var num0Bridge     = #[var numBridge].0]\n#[var num0CIM        = #[var numCIM].0]\n#[var num0Devenv     = #[var numDevenv].0]\n#[var num0Provider   = #[var numProvider].0]\n\n#[var libCore       = #[var numSBE]]\n#[var libCoreInt    = $([System.Convert]::ToInt32(\"$(libCore.Replace('.', '0'))\"))]#[\" v0.12.5 -> 1205 \"]\n\n#[var cfgSDK = #[( $(Configuration) =^ \"_SDK15\" ) {15} else {10} ]]",
        "Command__": [
          "#[\"",
          "    Prepares data - version, revBuild & information from git",
          "\"]",
          "",
          "#[var tBase     = $([System.DateTime]::Parse('$(revDeltaBase)').ToBinary())]",
          "#[var tNow      = $([System.DateTime]::UtcNow.Ticks)]",
          "#[var revBuild  = $([System.TimeSpan]::FromTicks('$([MSBuild]::Subtract($(tNow), $(tBase)))').TotalMinutes.ToString('0'))]",
          "#[var revBuild  = $([MSBuild]::Add($(revDeltaMin), $([MSBuild]::Modulo($(revBuild), $([MSBuild]::Subtract($(revDeltaMax), $(revDeltaMin)))))))]",
          "",
          "#[var tplVersion = #[File get(\"Version.tpl\")]]",
          "",
          "#[var pDir          = vsSolutionBuildEvent/]",
          "#[var pDirBridge    = Bridge/]",
          "#[var pDirCIM       = CI.MSBuild/]",
          "#[var pDirDevenv    = Devenv\\]",
          "#[var pDirProvider  = Provider/]",
          "#[var pMvsSln       = MvsSln/]",
          "",
          "#[var numSBE        = #[File get(\".version\")]]",
          "#[var numBridge     = #[File get(\"#[var pDirBridge].version\")]]",
          "#[var numCIM        = #[File get(\"#[var pDirCIM].version\")]]",
          "#[var numDevenv     = #[File get(\"#[var pDirDevenv].version\")]]",
          "#[var numProvider   = #[File get(\"#[var pDirProvider].version\")]]",
          "",
          "#[\" the 0 number is reserved for patches from external assemblies /see AssemblyInfo \"]",
          "",
          "#[var num0Bridge     = #[var numBridge].0]",
          "#[var num0CIM        = #[var numCIM].0]",
          "#[var num0Devenv     = #[var numDevenv].0]",
          "#[var num0Provider   = #[var numProvider].0]",
          "",
          "#[var libCore       = #[var numSBE]]",
          "#[var libCoreInt    = $([System.Convert]::ToInt32(\"$(libCore.Replace('.', '0'))\"))]#[\" v0.12.5 -> 1205 \"]",
          "",
          "#[var cfgSDK = #[( $(Configuration) =^ \"_SDK15\" ) {15} else {10} ]]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "ModulesAndPkg",
      "Caption": "Submodules and dep packages",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": false,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[( !(#[IO exists.file(\"$(pMvsSln)/MvsSln.sln\")]) )\n{\n    #[File call(\"git\", \"submodule update --init --recursive MvsSln\", 1000)]\n}]\n\n#[( !(#[IO exists.file(\"SobaScript/SobaScript.sln\")]) )\n{\n    #[File call(\"git\", \"submodule update --init --recursive SobaScript\", 1000)]\n    #[File call(\"git\", \"submodule update --init --recursive E-MSBuild\", 1000)]\n}]\n\n#[( !(#[IO exists.file(\"SobaScript.Z.Core/SobaScript.Z.Core.sln\")]) )\n{\n    #[File call(\"git\", \"submodule update --init --recursive SobaScript.Z.Core\", 1000)]\n    #[File call(\"git\", \"submodule update --init --recursive SobaScript.Z.Ext\", 1000)]\n    #[File call(\"git\", \"submodule update --init --recursive SobaScript.Z.VS\", 1000)]\n}]\n\n\n\n#[\" Packages \"]\n\n#[( !(#[IO exists.file(\"packages/__checked\")]) || !(#[IO exists.directory(\"$(pMvsSln)/packages\")]) )\n{\n    #[File call(\"tools\\hmsbuild.bat\", \"-t:restore /v:q /nologo /p:Configuration=$(Configuration) /p:Platform=\\\"Any CPU\\\"\", 1000)]\n    \n    #[File call(\"packages.cmd\", \"\", 1000)]\n    \n    #[IO copy.directory(\"\", \"packages/\", true)]\n    #[File write(\"packages/__checked\"): ]\n}]",
        "Command__": [
          "#[( !(#[IO exists.file(\"$(pMvsSln)/MvsSln.sln\")]) )",
          "{",
          "    #[File call(\"git\", \"submodule update --init --recursive MvsSln\", 1000)]",
          "}]",
          "",
          "#[( !(#[IO exists.file(\"SobaScript/SobaScript.sln\")]) )",
          "{",
          "    #[File call(\"git\", \"submodule update --init --recursive SobaScript\", 1000)]",
          "    #[File call(\"git\", \"submodule update --init --recursive E-MSBuild\", 1000)]",
          "}]",
          "",
          "#[( !(#[IO exists.file(\"SobaScript.Z.Core/SobaScript.Z.Core.sln\")]) )",
          "{",
          "    #[File call(\"git\", \"submodule update --init --recursive SobaScript.Z.Core\", 1000)]",
          "    #[File call(\"git\", \"submodule update --init --recursive SobaScript.Z.Ext\", 1000)]",
          "    #[File call(\"git\", \"submodule update --init --recursive SobaScript.Z.VS\", 1000)]",
          "}]",
          "",
          "",
          "",
          "#[\" Packages \"]",
          "",
          "#[( !(#[IO exists.file(\"packages/__checked\")]) || !(#[IO exists.directory(\"$(pMvsSln)/packages\")]) )",
          "{",
          "    #[File call(\"tools\\hmsbuild.bat\", \"-t:restore /v:q /nologo /p:Configuration=$(Configuration) /p:Platform=\\\"Any CPU\\\"\", 1000)]",
          "    ",
          "    #[File call(\"packages.cmd\", \"\", 1000)]",
          "    ",
          "    #[IO copy.directory(\"\", \"packages/\", true)]",
          "    #[File write(\"packages/__checked\"): ]",
          "}]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "Version",
      "Caption": "Updating version for vsSBE",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[\" \n    Checking of the git to define sha1, branch name, etc.\n\"]\n#[var isGit = #[IO cmd(\"git rev-parse 2>&1\")]]\n#[( $(isGit) == \"\" )\n{\n    #[var branchSha1        = #[File sout(\"git\", \"rev-parse --short HEAD\")]]\n    #[var branchName        = #[File sout(\"git\", \"rev-parse --abbrev-ref HEAD\")]]\n    #[var branchRevCount    = #[File sout(\"git\", \"rev-list HEAD --count\")]]\n    \n    #[var csVersion = $(tplVersion.Replace(%branchName%, \"$(branchName)\").Replace(%branchSha1%, \"$(branchSha1)\").Replace(%branchRevCount%, \"$(branchRevCount)\"))]\n    \n    #[($(branchName) == \"HEAD\") {\n        #[var branchName = $(APPVEYOR_REPO_BRANCH)]\n    }]\n}\nelse {\n    #[var branchSha1 =-] #[var branchName =-] #[var branchRevCount =-]\n    #[var csVersion = $(tplVersion.Replace(%branchName%, \"-\").Replace(%branchSha1%, \"-\").Replace(%branchRevCount%, \"-\"))]\n}]\n\n\n#[\"\n    'vsSolutionBuildEvent' project\n\"]\n\n#[var cs = $(csVersion.Replace(\"%Version%\", \"$(numSBE.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \"\"))]\n#[var cs = $(cs.Replace(\"%VersionRevString%\", \"$(numSBE).$(revBuild)\").Replace(\"%VersionString%\", \"$(numSBE)\"))]\n#[File write(\"#[var pDir]Version.cs\"):#[var cs]]\n\n\n#[\"\n    .vsixmanifest\n\"]\n\n#[( $(Configuration) ^= \"RCI_\" ) {\n    #[var numSBE = #[var numSBE].#[var revBuild]]\n}]\n#[File replace.Regexp(\"#[var pDir]/sdk10.vsixmanifest\", \"<Version>[0-9.]+</Version>\", \"<Version>#[var numSBE]</Version>\")]\n\n#[File replace.Regexp(\"#[var pDir]/sdk15.vsixmanifest\", \"(<Identity.*?) Version=\\\"[0-9.]+\\\"\", \"$1 Version=\\\"#[var numSBE]\\\"\")]\n",
        "Command__": [
          "#[\" ",
          "    Checking of the git to define sha1, branch name, etc.",
          "\"]",
          "#[var isGit = #[IO cmd(\"git rev-parse 2>&1\")]]",
          "#[( $(isGit) == \"\" )",
          "{",
          "    #[var branchSha1        = #[File sout(\"git\", \"rev-parse --short HEAD\")]]",
          "    #[var branchName        = #[File sout(\"git\", \"rev-parse --abbrev-ref HEAD\")]]",
          "    #[var branchRevCount    = #[File sout(\"git\", \"rev-list HEAD --count\")]]",
          "    ",
          "    #[var csVersion = $(tplVersion.Replace(%branchName%, \"$(branchName)\").Replace(%branchSha1%, \"$(branchSha1)\").Replace(%branchRevCount%, \"$(branchRevCount)\"))]",
          "    ",
          "    #[($(branchName) == \"HEAD\") {",
          "        #[var branchName = $(APPVEYOR_REPO_BRANCH)]",
          "    }]",
          "}",
          "else {",
          "    #[var branchSha1 =-] #[var branchName =-] #[var branchRevCount =-]",
          "    #[var csVersion = $(tplVersion.Replace(%branchName%, \"-\").Replace(%branchSha1%, \"-\").Replace(%branchRevCount%, \"-\"))]",
          "}]",
          "",
          "",
          "#[\"",
          "    'vsSolutionBuildEvent' project",
          "\"]",
          "",
          "#[var cs = $(csVersion.Replace(\"%Version%\", \"$(numSBE.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \"\"))]",
          "#[var cs = $(cs.Replace(\"%VersionRevString%\", \"$(numSBE).$(revBuild)\").Replace(\"%VersionString%\", \"$(numSBE)\"))]",
          "#[File write(\"#[var pDir]Version.cs\"):#[var cs]]",
          "",
          "",
          "#[\"",
          "    .vsixmanifest",
          "\"]",
          "",
          "#[( $(Configuration) ^= \"RCI_\" ) {",
          "    #[var numSBE = #[var numSBE].#[var revBuild]]",
          "}]",
          "#[File replace.Regexp(\"#[var pDir]/sdk10.vsixmanifest\", \"<Version>[0-9.]+</Version>\", \"<Version>#[var numSBE]</Version>\")]",
          "",
          "#[File replace.Regexp(\"#[var pDir]/sdk15.vsixmanifest\", \"(<Identity.*?) Version=\\\"[0-9.]+\\\"\", \"$1 Version=\\\"#[var numSBE]\\\"\")]",
          ""
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "Fvsixmanifest",
      "Caption": "source.extension.vsixmanifest",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[IO copy.file(\"$(pDir)/sdk$(cfgSDK).vsixmanifest\", \"$(pDir)/source.extension.vsixmanifest\", true)]\n",
        "Command__": [
          "#[IO copy.file(\"$(pDir)/sdk$(cfgSDK).vsixmanifest\", \"$(pDir)/source.extension.vsixmanifest\", true)]",
          ""
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "VerProjects",
      "Caption": "Updating version for all subprojects",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[\"\n    for 'Bridge'\n\"]\n\n#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0Bridge.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".Bridge\"))]\n#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0Bridge).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0Bridge)\"))]\n#[File write(\"#[var pDirBridge]Version.cs\"):#[var cs]]\n\n#[\"\n    for 'CI.MSBuild'\n\"]\n\n#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0CIM.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".CI.MSBuild\"))]\n#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0CIM).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0CIM)\"))]\n#[File write(\"#[var pDirCIM]Version.cs\"):#[var cs]]\n\n#[\"\n    for 'Devenv'\n\"]\n\n#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0Devenv.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".Devenv\"))]\n#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0Devenv).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0Devenv)\"))]\n#[File write(\"#[var pDirDevenv]Version.cs\"):#[var cs]]\n\n#[\"\n    for 'Provider'\n\"]\n\n#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0Provider.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".Provider\"))]\n#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0Provider).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0Provider)\"))]\n#[File write(\"#[var pDirProvider]Version.cs\"):#[var cs]]",
        "Command__": [
          "#[\"",
          "    for 'Bridge'",
          "\"]",
          "",
          "#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0Bridge.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".Bridge\"))]",
          "#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0Bridge).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0Bridge)\"))]",
          "#[File write(\"#[var pDirBridge]Version.cs\"):#[var cs]]",
          "",
          "#[\"",
          "    for 'CI.MSBuild'",
          "\"]",
          "",
          "#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0CIM.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".CI.MSBuild\"))]",
          "#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0CIM).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0CIM)\"))]",
          "#[File write(\"#[var pDirCIM]Version.cs\"):#[var cs]]",
          "",
          "#[\"",
          "    for 'Devenv'",
          "\"]",
          "",
          "#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0Devenv.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".Devenv\"))]",
          "#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0Devenv).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0Devenv)\"))]",
          "#[File write(\"#[var pDirDevenv]Version.cs\"):#[var cs]]",
          "",
          "#[\"",
          "    for 'Provider'",
          "\"]",
          "",
          "#[var cs    = $(csVersion.Replace(\"%Version%\", \"$(num0Provider.Replace('.', ', ')), $(revBuild)\").Replace(\"%namespace%\", \".Provider\"))]",
          "#[var cs    = $(cs.Replace(\"%VersionRevString%\", \"$(num0Provider).$(revBuild)\").Replace(\"%VersionString%\", \"$(num0Provider)\"))]",
          "#[File write(\"#[var pDirProvider]Version.cs\"):#[var cs]]"
        ]
      }
    }
  ],
  "PostBuild": [
    {
      "Enabled": false,
      "Name": "Tests",
      "Caption": "Run all tests for release configurations",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": [
          {
            "Project": "vsSolutionBuildEvent",
            "Order": "After"
          }
        ]
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[($([System.Convert]::ToInt32(\"$(VisualStudioVersion.Replace('.', ''))\")) < 120) {\n    #[($(Configuration) ^= \"REL_\" && !$(Configuration) ^= \"CI_\") {\n        #[DTE exec: Test.RunAllTestsInSolution]\n    }]\n}]",
        "Command__": [
          "#[($([System.Convert]::ToInt32(\"$(VisualStudioVersion.Replace('.', ''))\")) < 120) {",
          "    #[($(Configuration) ^= \"REL_\" && !$(Configuration) ^= \"CI_\") {",
          "        #[DTE exec: Test.RunAllTestsInSolution]",
          "    }]",
          "}]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "Definitions",
      "Caption": "Definitions for POST",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": false,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[var odir      = $(SolutionDir)bin/Releases/$(Configuration)/]\n#[var cfg       = #[( $(Configuration) ^= \"REL_\" || $(Configuration) ^= \"RCI_\" ){Release}else{Debug}]]\n#[var cfgFull   = $(Configuration)]\n#[var CIMLib    = $(SolutionDir)CIMLib\\bin\\]\n\n#[\" #[var netStamp      = net$(TargetFrameworkVersion.Replace(\".\", \"\").Replace(\"v\", \"\"))] \"]\n#[var netStamp      = $(NetTargetVName:vsSolutionBuildEvent)]\n#[var netVerString  = $(TargetFrameworkVersion:vsSolutionBuildEvent)]\n#[var msbuildver    = v$(MSBuildToolsVersion)]\n\n#[var tplNuspec = #[File get(\"tools/vsSBE.CI.MSBuild.nuspec\")]]\n\n#[IO delete.directory(\"$(odir)\", true)]\n#[IO copy.directory(\"\", \"$(odir)\", true)]",
        "Command__": [
          "#[var odir      = $(SolutionDir)bin/Releases/$(Configuration)/]",
          "#[var cfg       = #[( $(Configuration) ^= \"REL_\" || $(Configuration) ^= \"RCI_\" ){Release}else{Debug}]]",
          "#[var cfgFull   = $(Configuration)]",
          "#[var CIMLib    = $(SolutionDir)CIMLib\\bin\\]",
          "",
          "#[\" #[var netStamp      = net$(TargetFrameworkVersion.Replace(\".\", \"\").Replace(\"v\", \"\"))] \"]",
          "#[var netStamp      = $(NetTargetVName:vsSolutionBuildEvent)]",
          "#[var netVerString  = $(TargetFrameworkVersion:vsSolutionBuildEvent)]",
          "#[var msbuildver    = v$(MSBuildToolsVersion)]",
          "",
          "#[var tplNuspec = #[File get(\"tools/vsSBE.CI.MSBuild.nuspec\")]]",
          "",
          "#[IO delete.directory(\"$(odir)\", true)]",
          "#[IO copy.directory(\"\", \"$(odir)\", true)]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "ReleaseNotes",
      "Caption": "Release notes",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[var buildInfo =\n\n* Configuration:   '#[var cfgFull]' ( #[var cfg] );\n* SDK base:         #[var cfgSDK];\n* .NET version:     #[var netVerString];\n* Platform:         #[$(Platform)];\n* MSBuild Tools:    #[var msbuildver];\n* Build number:     #[var revBuild];\n* Branch Sha1:      #[var branchSha1];\n* Branch Name:      #[var branchName];\n* Branch revCount:  #[var branchRevCount];\n* revDeltaBase:     #[$(revDeltaBase)];    \n* revDeltaMin:      #[$(revDeltaMin)];    \n* revDeltaMax:      #[$(revDeltaMax)];\n------------------------------------------\n\nVersions:\n\n* The 'Bridge':                 v#[var numBridge];\n* The 'CI.MSBuild':             v#[var numCIM];\n#[( $(cfgSDK) == 10 ) { \n* The 'Devenv':                 v#[var numDevenv];\n}\nelse {\n* The 'Devenv':                 Unavailable for SDK#[$(cfgSDK)];\n}]\n* The 'Provider':               v#[var numProvider];\n* The 'vsSolutionBuildEvent':   v#[var numSBE];\n\nPackages:\n\n* NuGet 'vsSBE.CI.MSBuild': v#[var numCIM].#[var libCoreInt];\n\nDemo:\n\n* ClientDemo - [#[var branchSha1]][#[var netStamp]] (#[var revBuild]);\n\n------------------------------------------\n    :: generated by a vsSolutionBuildEvent v#[$(vsSolutionBuildEvent)]  \n------------------------------------------  \nhttps://github.com/3F/vsSolutionBuildEvent\n]\n\n#[File writeLine(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\"):#[var buildInfo]]\n\n#[var tplNuspec = $(tplNuspec.Replace(\"{build_info}\", \"$(buildInfo)\"))]",
        "Command__": [
          "#[var buildInfo =",
          "",
          "* Configuration:   '#[var cfgFull]' ( #[var cfg] );",
          "* SDK base:         #[var cfgSDK];",
          "* .NET version:     #[var netVerString];",
          "* Platform:         #[$(Platform)];",
          "* MSBuild Tools:    #[var msbuildver];",
          "* Build number:     #[var revBuild];",
          "* Branch Sha1:      #[var branchSha1];",
          "* Branch Name:      #[var branchName];",
          "* Branch revCount:  #[var branchRevCount];",
          "* revDeltaBase:     #[$(revDeltaBase)];    ",
          "* revDeltaMin:      #[$(revDeltaMin)];    ",
          "* revDeltaMax:      #[$(revDeltaMax)];",
          "------------------------------------------",
          "",
          "Versions:",
          "",
          "* The 'Bridge':                 v#[var numBridge];",
          "* The 'CI.MSBuild':             v#[var numCIM];",
          "#[( $(cfgSDK) == 10 ) { ",
          "* The 'Devenv':                 v#[var numDevenv];",
          "}",
          "else {",
          "* The 'Devenv':                 Unavailable for SDK#[$(cfgSDK)];",
          "}]",
          "* The 'Provider':               v#[var numProvider];",
          "* The 'vsSolutionBuildEvent':   v#[var numSBE];",
          "",
          "Packages:",
          "",
          "* NuGet 'vsSBE.CI.MSBuild': v#[var numCIM].#[var libCoreInt];",
          "",
          "Demo:",
          "",
          "* ClientDemo - [#[var branchSha1]][#[var netStamp]] (#[var revBuild]);",
          "",
          "------------------------------------------",
          "    :: generated by a vsSolutionBuildEvent v#[$(vsSolutionBuildEvent)]  ",
          "------------------------------------------  ",
          "https://github.com/3F/vsSolutionBuildEvent",
          "]",
          "",
          "#[File writeLine(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\"):#[var buildInfo]]",
          "",
          "#[var tplNuspec = $(tplNuspec.Replace(\"{build_info}\", \"$(buildInfo)\"))]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "PackBridge",
      "Caption": "Pack 'Bridge'",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(pDirBridge)bin\\$(cfg)\\\\\", true)]\n#[7z pack.files(\n{ \n            \"$(pDirBridge)bin\\$(cfg)\\Bridge.dll\", \n            \"$(pDirBridge)bin\\$(cfg)\\Bridge.pdb\",\n            \n        #[( $(cfg) == \"Release\" ) { \n            \"$(pDirBridge)bin\\$(cfg)\\Bridge.xml\",\n        }]\n            \"$(pDirBridge)bin\\$(cfg)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\" \n},\n\"$(odir)Bridge.$(numBridge)+$(branchSha1).SDK$(cfgSDK).zip\")]",
        "Command__": [
          "#[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(pDirBridge)bin\\$(cfg)\\\\\", true)]",
          "#[7z pack.files(",
          "{ ",
          "            \"$(pDirBridge)bin\\$(cfg)\\Bridge.dll\", ",
          "            \"$(pDirBridge)bin\\$(cfg)\\Bridge.pdb\",",
          "            ",
          "        #[( $(cfg) == \"Release\" ) { ",
          "            \"$(pDirBridge)bin\\$(cfg)\\Bridge.xml\",",
          "        }]",
          "            \"$(pDirBridge)bin\\$(cfg)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\" ",
          "},",
          "\"$(odir)Bridge.$(numBridge)+$(branchSha1).SDK$(cfgSDK).zip\")]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "PackProvider",
      "Caption": "Pack 'Provider'",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(pDirProvider)bin\\$(cfg)\\\\\", true)]\n#[7z pack.files(\n{\n            \"$(pDirProvider)bin\\$(cfg)\\Bridge.dll\", \n            \"$(pDirProvider)bin\\$(cfg)\\Bridge.pdb\",\n            \n        #[( $(cfg) == \"Release\" ) { \n            \"$(pDirProvider)bin\\$(cfg)\\Bridge.xml\",\n            \"$(pDirProvider)bin\\$(cfg)\\Provider.xml\",\n        }]\n            \n            \"$(pDirProvider)bin\\$(cfg)\\Provider.dll\",\n            \"$(pDirProvider)bin\\$(cfg)\\Provider.pdb\",\n            \"$(pDirProvider)bin\\$(cfg)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\" \n            \n}, \n\"$(odir)Provider.$(numProvider)+$(branchSha1).SDK$(cfgSDK).zip\")]",
        "Command__": [
          "#[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(pDirProvider)bin\\$(cfg)\\\\\", true)]",
          "#[7z pack.files(",
          "{",
          "            \"$(pDirProvider)bin\\$(cfg)\\Bridge.dll\", ",
          "            \"$(pDirProvider)bin\\$(cfg)\\Bridge.pdb\",",
          "            ",
          "        #[( $(cfg) == \"Release\" ) { ",
          "            \"$(pDirProvider)bin\\$(cfg)\\Bridge.xml\",",
          "            \"$(pDirProvider)bin\\$(cfg)\\Provider.xml\",",
          "        }]",
          "            ",
          "            \"$(pDirProvider)bin\\$(cfg)\\Provider.dll\",",
          "            \"$(pDirProvider)bin\\$(cfg)\\Provider.pdb\",",
          "            \"$(pDirProvider)bin\\$(cfg)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\" ",
          "            ",
          "}, ",
          "\"$(odir)Provider.$(numProvider)+$(branchSha1).SDK$(cfgSDK).zip\")]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "PackCIMSBuild",
      "Caption": "Pack 'CI.MSBuild'",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(pDirCIM)bin\\$(cfg)\\\\\", true)]\n#[7z pack.files(\n{\n            \"$(pDirCIM)bin\\$(cfg)\\Bridge.dll\", \n            \"$(pDirCIM)bin\\$(cfg)\\Bridge.pdb\",\n            \"$(pDirCIM)bin\\$(cfg)\\Provider.dll\",\n            \"$(pDirCIM)bin\\$(cfg)\\Provider.pdb\",\n            \n        #[( $(cfg) == \"Release\" ) { \n            \"$(pDirCIM)bin\\$(cfg)\\Bridge.xml\",\n            \"$(pDirCIM)bin\\$(cfg)\\Provider.xml\",\n            \"$(pDirCIM)bin\\$(cfg)\\CI.MSBuild.xml\",\n        }]\n            \n            \"$(pDirCIM)bin\\$(cfg)\\CI.MSBuild.dll\",\n            \"$(pDirCIM)bin\\$(cfg)\\CI.MSBuild.pdb\",\n            \"$(pDirCIM)bin\\$(cfg)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\"\n},\n\"$(odir)CI.MSBuild.$(numCIM)+$(branchSha1).SDK$(cfgSDK).zip\")]",
        "Command__": [
          "#[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(pDirCIM)bin\\$(cfg)\\\\\", true)]",
          "#[7z pack.files(",
          "{",
          "            \"$(pDirCIM)bin\\$(cfg)\\Bridge.dll\", ",
          "            \"$(pDirCIM)bin\\$(cfg)\\Bridge.pdb\",",
          "            \"$(pDirCIM)bin\\$(cfg)\\Provider.dll\",",
          "            \"$(pDirCIM)bin\\$(cfg)\\Provider.pdb\",",
          "            ",
          "        #[( $(cfg) == \"Release\" ) { ",
          "            \"$(pDirCIM)bin\\$(cfg)\\Bridge.xml\",",
          "            \"$(pDirCIM)bin\\$(cfg)\\Provider.xml\",",
          "            \"$(pDirCIM)bin\\$(cfg)\\CI.MSBuild.xml\",",
          "        }]",
          "            ",
          "            \"$(pDirCIM)bin\\$(cfg)\\CI.MSBuild.dll\",",
          "            \"$(pDirCIM)bin\\$(cfg)\\CI.MSBuild.pdb\",",
          "            \"$(pDirCIM)bin\\$(cfg)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\"",
          "},",
          "\"$(odir)CI.MSBuild.$(numCIM)+$(branchSha1).SDK$(cfgSDK).zip\")]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "PackDevenv",
      "Caption": "Pack 'Devenv'",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[( $(cfgSDK) == 10 )\n{ \n    #[var _DP = $(SolutionDir)$(pDirDevenv)bin\\#[var cfg]\\]\n    \n    #[IO delete.directory(\"$(_DP)Devenv\", true)]\n    #[IO copy.directory(\"\", \"$(_DP)Devenv\", true)]\n    \n    #[IO copy.file({\n                    \"$(_DP)Bridge.*\",\n                    \"$(_DP)Provider.*\",\n                    \"$(_DP)Devenv.*\"\n                   },\n                   \"$(_DP)Devenv\\\\\", true, {\"Devenv.AddIn\"})]\n    \n    #[( #[IO exists.file(\"$(_DP)Extensibility.dll\")] ) {\n        #[IO copy.file(\"$(_DP)Extensibility.dll\", \"$(_DP)\\Devenv\\\\\", true)]\n    }]\n    \n    #[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(_DP)Devenv\\\\\", true)]\n    #[7z pack.files({\"$(_DP)Devenv.AddIn\", \"$(_DP)Devenv\\*.*\"}, \"$(odir)Devenv.$(numDevenv)+$(branchSha1).SDK$(cfgSDK).zip\")]\n    \n}]",
        "Command__": [
          "#[( $(cfgSDK) == 10 )",
          "{ ",
          "    #[var _DP = $(SolutionDir)$(pDirDevenv)bin\\#[var cfg]\\]",
          "    ",
          "    #[IO delete.directory(\"$(_DP)Devenv\", true)]",
          "    #[IO copy.directory(\"\", \"$(_DP)Devenv\", true)]",
          "    ",
          "    #[IO copy.file({",
          "                    \"$(_DP)Bridge.*\",",
          "                    \"$(_DP)Provider.*\",",
          "                    \"$(_DP)Devenv.*\"",
          "                   },",
          "                   \"$(_DP)Devenv\\\\\", true, {\"Devenv.AddIn\"})]",
          "    ",
          "    #[( #[IO exists.file(\"$(_DP)Extensibility.dll\")] ) {",
          "        #[IO copy.file(\"$(_DP)Extensibility.dll\", \"$(_DP)\\Devenv\\\\\", true)]",
          "    }]",
          "    ",
          "    #[IO copy.file(\"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\", \"$(_DP)Devenv\\\\\", true)]",
          "    #[7z pack.files({\"$(_DP)Devenv.AddIn\", \"$(_DP)Devenv\\*.*\"}, \"$(odir)Devenv.$(numDevenv)+$(branchSha1).SDK$(cfgSDK).zip\")]",
          "    ",
          "}]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "PackVSSBE",
      "Caption": "Pack 'vsSBE'",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[IO copy.file(\n            \"$(pDir)bin\\$(cfg)\\vsSolutionBuildEvent.vsix\", \n            \"$(odir)vsSolutionBuildEvent.$(numSBE)+$(branchSha1).SDK$(cfgSDK).vsix\", \n            true)]",
        "Command__": [
          "#[IO copy.file(",
          "            \"$(pDir)bin\\$(cfg)\\vsSolutionBuildEvent.vsix\", ",
          "            \"$(odir)vsSolutionBuildEvent.$(numSBE)+$(branchSha1).SDK$(cfgSDK).vsix\", ",
          "            true)]"
        ]
      }
    },
    {
      "Enabled": false,
      "Name": "VerCIMPrompt",
      "Caption": "Gets next number for package from official nuget server",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": true,
      "ToConfiguration": [
        "REL_SDK10|Any CPU",
        "REL_SDK15|Any CPU"
      ],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[($(Configuration) ^= \"REL_\" && !$(Configuration) ^= \"CI_\") {\n    #[var numCIMPackage = $([MSBuild]::Add(#[File sout(\"cmd\", \"/C .nuget\\nuget.exe list vsSBE.CI.MSBuild | grep 'vsSBE.CI.MSBuild' | sed -r 's/^.*\\s[0-9]+\\.[0-9]+\\.//'\")], 1))]\n}\nelse{\n    #[var numCIMPackage = 0]\n}]",
        "Command__": [
          "#[($(Configuration) ^= \"REL_\" && !$(Configuration) ^= \"CI_\") {",
          "    #[var numCIMPackage = $([MSBuild]::Add(#[File sout(\"cmd\", \"/C .nuget\\nuget.exe list vsSBE.CI.MSBuild | grep 'vsSBE.CI.MSBuild' | sed -r 's/^.*\\s[0-9]+\\.[0-9]+\\.//'\")], 1))]",
          "}",
          "else{",
          "    #[var numCIMPackage = 0]",
          "}]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "NuGetCIM",
      "Caption": "NuGet pack - CI.MSBuild",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[var nupCIMdir = $(odir)NuGet-CI.MSBuild-package]\n\n#[IO delete.directory(\"$(nupCIMdir)\", true)]\n#[IO copy.directory(\"\", \"$(nupCIMdir)\", true)]\n\n#[var nuspec = $(tplNuspec.Replace(\"%CIM%\", \"$(numCIM)\").Replace(\"%Lib%\", \"$(libCoreInt)\").Replace(\"%vsSBE%\", \"$(numSBE)\"))]\n#[File write(\"$(nupCIMdir)\\vsSBE.CI.MSBuild.nuspec\"):#[var nuspec]]\n\n#[\" files for package \"]\n\n#[IO copy.file(\"$(CIMLib)\\*.dll\", \"$(nupCIMdir)\\bin\\\\\", true)]#[\" CIMLib custom \"]\n\n#[\" vsix dir \"]\n#[IO copy.file({\n                 \"$(pDir)bin/$(cfg)\\*.dll\",\n                 \"$(pDirCIM)bin/$(cfg)\\*.dll\",\n                 \"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\",\n                 \"3rd-party\",\n                 \"changelog.txt\",\n                 \"LICENSE\",\n                 \"$(pDirCIM)bin/$(cfg)\\*.bat\" \n               },\n               \"$(nupCIMdir)\\bin\\\\\", true)]\n               \n#[IO copy.file({\n                 \"README.md\"\n               },\n               \"$(nupCIMdir)\", true)]\n\n\n#[\" xml doc \"]\n#[( $(cfg) == \"Release\" )\n{\n    #[IO copy.file({\n                     \"$(pDirCIM)bin/$(cfg)\\Bridge.xml\",\n                     \"$(pDirCIM)bin/$(cfg)\\Provider.xml\",\n                     \"$(pDirCIM)bin/$(cfg)\\CI.MSBuild.xml\",\n                     \"$(pDir)bin/$(cfg)\\vsSolutionBuildEvent.xml\"\n                   }, \n                   \"$(nupCIMdir)\\bin\\\\\", true)]\n}]\n\n#[NuGet gnt.raw(\"gnt.core /t:pack /p:ngin=\\\"$(nupCIMdir)\\\" /p:ngout=\\\"$(odir)\\\"\")]\n#[IO delete.directory(\"$(nupCIMdir)\", true)]\n\n#[IO copy.file(\"$(odir)\\vsSBE.CI.MSBuild.$(numCIM).$(libCoreInt).nupkg\", \"$(odir)\\vsSBE.CI.MSBuild.$(numCIM).$(libCoreInt)+$(branchSha1).SDK$(cfgSDK).nupkg\", true)]\n#[IO delete.files({\"$(odir)\\vsSBE.CI.MSBuild.$(numCIM).$(libCoreInt).nupkg\"})]",
        "Command__": [
          "#[var nupCIMdir = $(odir)NuGet-CI.MSBuild-package]",
          "",
          "#[IO delete.directory(\"$(nupCIMdir)\", true)]",
          "#[IO copy.directory(\"\", \"$(nupCIMdir)\", true)]",
          "",
          "#[var nuspec = $(tplNuspec.Replace(\"%CIM%\", \"$(numCIM)\").Replace(\"%Lib%\", \"$(libCoreInt)\").Replace(\"%vsSBE%\", \"$(numSBE)\"))]",
          "#[File write(\"$(nupCIMdir)\\vsSBE.CI.MSBuild.nuspec\"):#[var nuspec]]",
          "",
          "#[\" files for package \"]",
          "",
          "#[IO copy.file(\"$(CIMLib)\\*.dll\", \"$(nupCIMdir)\\bin\\\\\", true)]#[\" CIMLib custom \"]",
          "",
          "#[\" vsix dir \"]",
          "#[IO copy.file({",
          "                 \"$(pDir)bin/$(cfg)\\*.dll\",",
          "                 \"$(pDirCIM)bin/$(cfg)\\*.dll\",",
          "                 \"$(odir)\\Release-notes.$(branchSha1).SDK$(cfgSDK).txt\",",
          "                 \"3rd-party\",",
          "                 \"changelog.txt\",",
          "                 \"LICENSE\",",
          "                 \"$(pDirCIM)bin/$(cfg)\\*.bat\" ",
          "               },",
          "               \"$(nupCIMdir)\\bin\\\\\", true)]",
          "               ",
          "#[IO copy.file({",
          "                 \"README.md\"",
          "               },",
          "               \"$(nupCIMdir)\", true)]",
          "",
          "",
          "#[\" xml doc \"]",
          "#[( $(cfg) == \"Release\" )",
          "{",
          "    #[IO copy.file({",
          "                     \"$(pDirCIM)bin/$(cfg)\\Bridge.xml\",",
          "                     \"$(pDirCIM)bin/$(cfg)\\Provider.xml\",",
          "                     \"$(pDirCIM)bin/$(cfg)\\CI.MSBuild.xml\",",
          "                     \"$(pDir)bin/$(cfg)\\vsSolutionBuildEvent.xml\"",
          "                   }, ",
          "                   \"$(nupCIMdir)\\bin\\\\\", true)]",
          "}]",
          "",
          "#[NuGet gnt.raw(\"gnt.core /t:pack /p:ngin=\\\"$(nupCIMdir)\\\" /p:ngout=\\\"$(odir)\\\"\")]",
          "#[IO delete.directory(\"$(nupCIMdir)\", true)]",
          "",
          "#[IO copy.file(\"$(odir)\\vsSBE.CI.MSBuild.$(numCIM).$(libCoreInt).nupkg\", \"$(odir)\\vsSBE.CI.MSBuild.$(numCIM).$(libCoreInt)+$(branchSha1).SDK$(cfgSDK).nupkg\", true)]",
          "#[IO delete.files({\"$(odir)\\vsSBE.CI.MSBuild.$(numCIM).$(libCoreInt).nupkg\"})]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "PackClientDemo",
      "Caption": "Pack 'ClientDemo'",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[var clientDemoDir = ClientDemo\\bin\\#[var cfg]\\]\n#[7z pack.files({\n            \"$(clientDemoDir)Bridge.dll\", \n            \"$(clientDemoDir)Bridge.pdb\",\n            \"$(clientDemoDir)client.vssbe.dll\",\n            \"$(clientDemoDir)client.vssbe.pdb\"}, \"$(odir)ClientDemo.$(branchSha1).SDK$(cfgSDK).zip\")]",
        "Command__": [
          "#[var clientDemoDir = ClientDemo\\bin\\#[var cfg]\\]",
          "#[7z pack.files({",
          "            \"$(clientDemoDir)Bridge.dll\", ",
          "            \"$(clientDemoDir)Bridge.pdb\",",
          "            \"$(clientDemoDir)client.vssbe.dll\",",
          "            \"$(clientDemoDir)client.vssbe.pdb\"}, \"$(odir)ClientDemo.$(branchSha1).SDK$(cfgSDK).zip\")]"
        ]
      }
    },
    {
      "Enabled": true,
      "Name": "GetterCIM",
      "Caption": "Generate getter of CIM package",
      "SupportMSBuild": true,
      "SupportSBEScripts": true,
      "IgnoreIfBuildFailed": true,
      "BuildType": "Common",
      "Confirmation": false,
      "ToConfiguration": [],
      "ExecutionOrder": {
        "$type": "net.r_eg.vsSBE.Events.ExecutionOrder[], vsSolutionBuildEvent",
        "$values": []
      },
      "Process": {
        "$type": "net.r_eg.vsSBE.Events.EventProcess, vsSolutionBuildEvent",
        "Waiting": true,
        "Hidden": true,
        "TimeLimit": 30
      },
      "Mode": {
        "$type": "net.r_eg.vsSBE.Events.ModeScript, vsSolutionBuildEvent",
        "Type": "Script",
        "Command": "#[$(getcimName = 'get.CIM.$(numCIM).$(libCoreInt).bat')]\n#[IO copy.file(\"$(SolutionDir)\\tools\\gnt.bat\", \"$(odir)\\$(getcimName)\", true)]\n\n#[File replace(\"$(odir)\\$(getcimName)\", \"/nologo\", \"/nologo /p:ngpackages=\\\"vsSBE.CI.MSBuild/$(numCIM).$(libCoreInt)\\\"\")]",
        "Command__": [
          "#[$(getcimName = 'get.CIM.$(numCIM).$(libCoreInt).bat')]",
          "#[IO copy.file(\"$(SolutionDir)\\tools\\gnt.bat\", \"$(odir)\\$(getcimName)\", true)]",
          "",
          "#[File replace(\"$(odir)\\$(getcimName)\", \"/nologo\", \"/nologo /p:ngpackages=\\\"vsSBE.CI.MSBuild/$(numCIM).$(libCoreInt)\\\"\")]"
        ]
      }
    }
  ],
  "CancelBuild": [],
  "WarningsBuild": [],
  "ErrorsBuild": [],
  "OWPBuild": [],
  "Transmitter": [],
  "CommandEvent": [],
  "Logging": [],
  "SlnOpened": [],
  "SlnClosed": []
}